for neuron_i = 1:size(bf_data,1)
    
    figure(neuron_i);
    subplot(2,1,1); hold on
    plot(-5000:5000,nanmean(bf_data.sdf{neuron_i}(bf_data.trials{neuron_i}.prob0,:)))
    plot(-5000:5000,nanmean(bf_data.sdf{neuron_i}(bf_data.trials{neuron_i}.prob25,:)))
    plot(-5000:5000,nanmean(bf_data.sdf{neuron_i}(bf_data.trials{neuron_i}.prob50,:)))
    plot(-5000:5000,nanmean(bf_data.sdf{neuron_i}(bf_data.trials{neuron_i}.prob75,:)))
    plot(-5000:5000,nanmean(bf_data.sdf{neuron_i}(bf_data.trials{neuron_i}.prob100,:)))
    xlim([-500 3000]); vline(0, 'k'); vline(1000,'k'); vline(1000+1500,'k')
    
    subplot(2,1,2); hold on
    plot(bf_data.fano(neuron_i).time,bf_data.fano(neuron_i).FanoSave100)
    plot(bf_data.fano(neuron_i).time,bf_data.fano(neuron_i).FanoSave75)
    plot(bf_data.fano(neuron_i).time,bf_data.fano(neuron_i).FanoSave50)
    plot(bf_data.fano(neuron_i).time,bf_data.fano(neuron_i).FanoSave25)
    plot(bf_data.fano(neuron_i).time,bf_data.fano(neuron_i).FanoSave0)
    xlim([-500 3000]); ylim([0 4]); hline(1,'k'), vline(0, 'k'); vline(1000,'k'); vline(1000+1500,'k')
    
end



epoch.fix = [0:200];
epoch.preCS = [-200:0];
epoch.postCS = [0:200];
epoch.midwait = [650:850];
epoch.preOutcome = [-200:0];
epoch.postOutcome = [-200:0];


epoch_labels = fieldnames(epoch);

for neuron_i = 1:size(bf_data,1)
    for epoch_i = 1:length(epoch_labels)
        epoch_index = [];
        epoch_index = find(ismember(bf_data.fano(neuron_i).time,epoch.fix));

        test(neuron_i,epoch_i) = mean(bf_data.fano(neuron_i).FanoSaveAll(epoch_index))
    end
    
end
